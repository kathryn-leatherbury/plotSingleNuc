% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MultiGeneFeatureDotPlot.R
\name{MultiGeneFeatureDotPlot}
\alias{MultiGeneFeatureDotPlot}
\title{Multi-gene UMAP(s) + DotPlot composite for Seurat objects}
\usage{
MultiGeneFeatureDotPlot(
  object,
  reduction = "umap",
  genes = NULL,
  na.cutoff = 0.5,
  max.expression = NULL,
  scale.legend = FALSE,
  scale.legend.max = FALSE,
  pt.size = 0.5,
  alpha = 0.5,
  group.by = NULL,
  label = TRUE,
  repel = FALSE,
  gene.ref.table = NULL,
  gene.ref.col = "mzebra_seurat_gene_id",
  new.name.col = "human_homolog",
  secondary.ref.col = "mzebra_to_human_true_homolog",
  convert.names = FALSE,
  assay = Seurat::DefaultAssay(object),
  legend.ncols = NULL,
  plot.title = NULL,
  split.by = NULL,
  split.umaps = FALSE,
  flip.axes = FALSE,
  umap.ncols = 3,
  plot.heights = NULL,
  plot.widths = NULL
)
}
\arguments{
\item{object}{Seurat object.}

\item{reduction}{Character. Embedding to use (e.g., "umap", "umap.wnn").}

\item{genes}{Character vector of genes (mzebra or human; mixed allowed).}

\item{na.cutoff}{Numeric. Values ≤ this are treated as “off” for plotting.}

\item{max.expression}{Optional numeric upper cap for color scales.}

\item{scale.legend}{Logical. If TRUE, force all genes to share the same limits.}

\item{scale.legend.max}{Logical. With scale.legend=TRUE, use max of per-gene 95th pct.}

\item{pt.size}{Numeric point size for UMAP.}

\item{alpha}{Numeric point alpha for UMAP.}

\item{group.by}{Column in meta.data (or vector/factor) for labels/DotPlot grouping.}

\item{label}{Logical. Draw cluster labels on UMAP(s).}

\item{repel}{Logical. Use ggrepel for labels (if available).}

\item{gene.ref.table}{Optional data.frame for homolog mapping.}

\item{gene.ref.col}{Column in gene.ref.table with mzebra IDs.}

\item{new.name.col}{Column with human homolog names.}

\item{secondary.ref.col}{Logical column indicating true homolog rows.}

\item{convert.names}{Logical. If TRUE, show human homologs in legends/x-axis.}

\item{assay}{Assay to use. Defaults to Seurat::DefaultAssay(object).}

\item{legend.ncols}{Optional integer. If set (and split.umaps=FALSE),
renders a separate multi-column legend panel next to the UMAP.}

\item{plot.title}{Optional title/subtitle for UMAP.}

\item{split.by}{Optional column name for DotPlot splitting.}

\item{split.umaps}{Logical. If TRUE, draw one UMAP per gene.}

\item{flip.axes}{Logical; if TRUE, DotPlot rotated & stacked under UMAP(s).}

\item{umap.ncols}{Integer. Columns for per-gene UMAP grid (when split.umaps=TRUE).}

\item{plot.heights}{Numeric length-2 for stacked layout (UMAPs, DotPlot).}

\item{plot.widths}{Numeric length-2 for side-by-side layout (UMAPs, DotPlot).}
}
\value{
A patchwork object combining UMAP (single or grid) and a DotPlot.
}
\description{
Builds either (a) a single composite UMAP with multi-gene color overlays
or (b) a grid of one UMAP per gene (controlled by \code{split.umaps}), and
appends a DotPlot summarizing expression across groups. Gene names can be
matched to assay features directly or via a homolog mapping table.
}
\examples{
\dontrun{
MultiGeneFeatureDotPlot(
  object = seurat_obj,
  reduction = "umap.wnn",
  genes = c("fat2","LOC101479120","cga","fabp7","myrf","pitx2"),
  gene.ref.table = homologs, convert.names = TRUE,
  label = TRUE, repel = TRUE,
  split.umaps = TRUE, umap.ncols = 3
)
}

}
